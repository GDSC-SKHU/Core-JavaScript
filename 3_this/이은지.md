# this

## 상황에 따라 달라지는 this

-this는 실행 컨텍스트가 생성될 때 함께 결정됨  
->this는 함수를 호출할 때 결정됨  
  
### 전역 공간에서의 this

- 전역 공간에서 this는 **전역 객체**를 가리킴
    - 브라우저 환경: window
    - Node.js 환경: global
  
-자바스크립트의 모든 변수는 특정 객체의 프로퍼티로서 동작함  
->전역변수를 선언하면 자바스크립트 엔진은 이를 전역객체의 프로퍼티로 할당함  
  
- 삭제 시
    - 처음부터 전역객체의 프로퍼티로 할당한 경우: 삭제O
    - 전역변수로 선언한 경우: 삭제X
  
### 메서드로서 호출할 때 그 메서드 내부에서의 this

- 함수를 실행하는 방법
    - 함수: 그 자체로 독립적인 기능 수행
    - 메서드: 자신을 호출한 대상 객체에 관한 동작 수행
->이 둘의 차이는 **독립성**에 있음(실제로 코드에서 구분할 때는 .으로 구분함)  
  
>.이 있으면 메서드로서 호출, .이 없으면 함수로서 호출  
   
### 함수로서 호출할 때 그 함수 내부에서의 this

-this에는 호출한 주체에 대한 정보가 담김  
-그러나 함수로서 호출하는 것은 호출 주체를 명시하지 않고 개발자가 코드에 직접 관여해 실행하기에 호출 주체의 정보를 알 수 없음  
->함수에서의 this는 전역 객체를 가리킴  
  
-호출 주체가 없을 때 자동으로 전역객체를 바인딩함  
  
### 콜백 함수 호출 시 그 함수 내부에서의 this

-함수 A의 제어권을 다른 함수(혹은 메서드) B에게 넘겨주는 경우 함수 A를 콜백 함수라 함  
-콜백 함수에서의 this: 콜백 함수의 제어권을 가지는 함수(메서드)가 콜백 함수에서의 this를 결정  
->특별히 정의 하지 않은 경우: 함수와 마찬가지로 전역객체를 바라봄  
  
### 생성자 함수 내부에서의 this

-생성자 함수: 어떤 공통된 성질을 지니는 객체들을 생성하는 데 사용하는 함수  
  
객체지향 언어에서의 용어  
>생성자->클래스
>클래스를 통해 만든 객체: 인스턴스

## 명시적으로 this를 바인딩하는 방법

### call 메서드

-call 메서드: 메서드의 호출 주체인 함수를 즉시 실행하도록 하는 명령어  
  
### apply 메서드

-apply 메서드: call 메서드와 기능적으로 완전히 동일  
  
**차이점**  
-call 메서드: 첫 번째 인자를 제외한 나머지 모든 인자들을 호출할 함수의 매개변수로 지정  
-apply 메서드: 두 번째 인자를 배열로 받아 그 배열의 요소들을 호출할 함수의 매개변수로 지정  
  
### call / apply 메서드의 활용

-객체에는 배열 메서드를 직접 적용할 수는 없지만, 키와 length 프로퍼티의 값이 0 또는 양의 정수인 객체는 존재  
->call / apply 메서드로 배열 메서드를 차용  
  
-생성자 내부에 다른 생성자와 공통된 내용이 있을 경우 call / apply 메서드를 이용해 다른 생성자를 호출하면 간단하게 반복을 줄일 수 있음  
  
-여러 인수를 묶어 하나의 배열로 전달하고 싶을 때  
->apply를 사용하는 게 코드가 간단해지고 가독성도 좋아짐  
  
### bind 메서드

-bind 메서드: call과 비슷하지만 즉시 호출하지는 않고 넘겨 받은 this 및 인수들을 바탕으로 새로운 함수를 반환하는 메서드  
->함수에 this를 미리 적용하는 것과 부분 적용 함수를 구현하는 두 가지 목적을 모두 지님  
  
-bind 메서드를 적용해 새로 만든 함수의 독특한 성질: name 프로퍼티에 'bound'라는 접두어가 붙음  
  
### 화살표 함수의 예외사항

-실행 컨텍스트 생성 시 this를 바인딩하는 과정이 제외  
   
## 정리
1. 전역공간에서의 this는 전역객체(window, global)를 참조  
2. 어떤 함수를 **메서드**로서 호출한 경우: this는 메서드 호출 주체(메서드명 앞의 객체)를 참조  
3. 어떤 함수를 **함수**로서 호출한 경우: this는 전역객체를 참조-메서드의 내부함수에서도 동일  
4. 콜백 함수 내부에서의 this: 해당 콜백 함수의 제어권을 넘겨받은 함수가 정의한 바에 따름-만약 정의하지 않았을 시 전역객체를 참조  
5. 생성자 함수에서의 this: 생성될 인스턴스를 참조  
  
위 규칙에 부합하지 않는 경우  
1. call / apply 메서드는 this를 명시적으로 지정하면서 함수 또는 메서드를 호출  
2. bind 메서드는 this 및 함수에 넘길 인수를 일부 지정해 새로운 함수를 만듦  
3. 요소를 순화하면서 콜백 함수를 반복 호출하는 내용의 일부 메서드는 별도의 인자로 this를 받음
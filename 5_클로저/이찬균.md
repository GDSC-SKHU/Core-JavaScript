중요하다고 생각한, 공유하고 싶은, 내가 몰랐던

# 5. 클로저

## 01. 클로저의 의미 및 원리 이해

클로저

- 함수와 그 함수가 선언될 당시의 lexical environment의 상호관계에 따른 현상 (MDN)
  -> 내부함수에서 외부 변수를 참조하는 경우에 한해서만 combination, 즉 '선언될 당시의 LexicalEnvironment와의 상호관계'가 의미가 있을 것

- 어떤 함수에서 선언한 변수를 참조하는 내부함수에서만 발생하는 현상
- **외부 함수의 LexicalEnvironment가 가비지 컬렉팅되지 않는 현상**

<img width="500" alt="스크린샷 2023-02-08 오후 9 12 40" src="https://user-images.githubusercontent.com/72643542/217526592-b9f0e22c-c85d-4add-b5ef-c164df5e044f.png">

위의 상태는 outer함수의 실행 컨텍스트가 종료되기 이전에 inner함수의 실행 컨택스트가 종료돼 있으며, 이후 별도로 inner함수를 호출할 수 없음

그렇다면, outer의 실행 컨택스트가 종료된 후에도 inner 함수를 호출할 수 있게 만든다면???

```js
var outer = function () {
  var a = 1;
  var inner = function () {
    return ++a;
  };
  return inner; // 함수 자체를 반환
};
var outer2 = outer();
console.log(outer2()); // 2
console.log(outer2()); // 3
```

이와 같은 때, 가비지 컬랙터는 어떤 값을 참조하는 변수가 있다면 그 그 값을 수집 대상에 포함 X
그래서 inner함수가 변수 a에 접근 가능

==So, 함수의 실행 컨텍스트가 종료된 후에도 Lexical Environment가 카비지 컬렉터의 수집 대상에서 제외되는 경우는 **지역 변수를 참조하는 내부함수가 외부로 전달된 경우**가 유일함==

**클로저 정의 변경**
=> _클로저란, 어떤 함수 A에서 선언한 변수 a를 참조하는 내부함수 B를 외부로 전달할 경우 A의 실행 컨텍스트가 종료된 이후에도 변수 a가 사라지지 않는 현상_

==내부 함수 B를 외부로 전달하는 방법==

- `return ;`
- 외부 객체인 window의 메서드에 전달할 콜백 함수 내부에서 지역변수를 참조
- 외부 객체인 DOM의 메서드에 등록할 handler 함수 내부에서 지역변수를 참조

## 02. 클로저와 메모리 관리

==참조 카운트를 0으로 만드는 방법==
-> 식별자에 참조형이 아닌 기본형 데이터(null이나 undefined)를 할당

## 03. 클로저 활용 사례

### 3-1. 콜백 함수 내부에서 외부 데이터를 사용하고자 할 때

1. 클로저 사용 - 콜백 함수를 내부함수로 선언해서 외부 변수를 직접 참조하는 방법
2. bind 활용 - bind 메서드로 값을 직접 넘겨준 덕분에 클로저는 발생하지 않게 된 반면 여러가지 제약 발생
3. 고차 함수 활용 - 콜백 함수를 고차 함수로 바꿔서 클로저를 적극적으로 활용한 방안

### 3-2. 접근 권한 제어 (은닉 정보)

**정보 은닉 (information hiding)**
어떤 모듈의 내부 로직에 대해 외부로의 노출을 최소화해서 모듈간의 결합도를 낮추고 유연성을 높임

접근 권한의 종류

1. public
2. private
3. protected

==클로저를 사용하면 pubilc & provate한 값을 구분 가능==

- return한 변수: public -> 외부에 접근 권한을 주고자 하는 대상들로 구성된 참조형 데이터
- 그렇지 않은 변수: private

### 3-3. 부분 적용 함수

n개의 인자를 받는 함수에 미리 m개의 인자만 넘겨 기억시켰다가, 나중에 n-m개의 인자를 넘기면 원래 함수의 실행 결과를 얻을 수 있게끔 하는 함수

### 3-4. 커링 함수

여러 개의 인자를 받는 함수를 하나의 인자만 받는 함수로 나눠서 순차적으로 호출될 수 있게 체인 형태로 구성한 것

- 한 번에 하나의 인자만 전달하는 것을 원칙
- ==마지막 인자가 전달되기 전까지는 원본 함수가 실행되지 않음==
- ES6에서의 화살표 함수를 통해 간략히 표현 가능
- 지연 실행

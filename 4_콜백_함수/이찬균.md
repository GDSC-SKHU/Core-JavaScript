# 4장. 콜백 함수

## 01. 콜백 함수란?

**콜백 함수**

- 다른 코드의 인자로 넘겨주는 함수
- 콜백 함수를 넘겨받은 코드는 이 콜백 함수를 필요에 따라 적적한 시점에 실행
- 다른 코드에게 인자로 넘겨줌으로써 그 제어권도 함께 위임한 함수

## 02. 제어권

### 2-1. 호출 시점

- 콜백 함수의 제어권을 넘겨받은 코드는 콜백 함수 호출 시점에 대한 제어권을 가진다.

### 2-2. 인자

**map 메서드**
첫 번째 인자로 callback함수를 받음
두 번째 인자로 콜백 함수 내부에서 this로 인식할 대상을 특정할 수 있음 -> 두 번째 인자는 생략 가능
thisArg를 생략할 경우 일반적인 함수와 마찬가지로 전역객체가 바인딩됨

- 메서드의 대상이 되는 배열의 모든 요소들을 처음부터 끝까지 하나씩 꺼내어 콜백 함수를 반복 호출
- 콜백 함수의 실행 결과들을 모아 새로운 배열을 만듦

콜백함수의

1. 첫 번째 인자 - 배열의 요소 중 현재값
2. 두 번째 인자 - 현재값의 인덱스
3. 세 번째 인자 - map메서드의 대상이 되는 배열 자체
   가 담김

**제이쿼리 메서드**
첫 번째 인자에 index
두 번째 인자에 currentValue

### 2-3. this

## 03. 콜백 함수는 함수다

콜백 함수로 어떤 객체의 메서드를 전달하더라도 그 메서드는 메서드가 아닌 함수로서 호출된다.

## 04. 콜백 함수 내부 this에 다른 값 바인딩하기

객체의 메서드를 콜백 함수로 전달하면 해당 객체를 this로 바라볼 수 없게 된다.
그럼에도 콜백 함수 내부에서 this가 객체를 바라보게 하고 싶다면?

-> 전통적인 방법

- this를 다른 변수에 담아 콜백 함수로 활용할 함수에서는 this 대신 그 변수를 사용하게 하고,
- 이를 클로저로 만든다.
  => 번거롭지만, this를 우회적으로나마 활용함으로써 다양한 상황에서 원하는 객체를 바라보는 콜백함수를 만들 수 있는 방법임

-> 콜백 함수 내부에서 this를 사용하지 않는 경우

- 처음부터 바라볼 객체를 명시적으로 지정했기 때문에 다른 방법으로 다른 객체를 바라보게끔 할 수 없음
- 불편 + 메모리 낭비

**ES5 이후**
bind 메서드를 이용하여 콜백 함수 내부의 this에 다른 값을 바인딩할 수 있음

## 05. 콜백 지옥과 비동기 제어

**콜백 지옥**

- 콜백 함수를 익명 함수로 전달하는 과정이 반복되어 코드의 들여쓰기 수준이 감당하기 힘들 정도로 깊어지는 현상
- 이벤트 처리나 서버 통신과 같이 비동기적인 작업을 수행하기 위해 이런 형태 등장

해결 방법 => 익명의 콜백 함수를 모두 기명 함수로 전환

**동기적인 코드**
현재 실행 중인 코드가 완료된 후에야 다음 코드를 실행하는 방식

**비동기적인 코드**
현재 실행중인 코드의 완료 여부와 무관하게 즉시 다음 코드로 넘어가는 방식

- 사용자의 요청에 의해 특정 시간이 경과되기 전까지 어떤 함수의 실행을 보류
- 사용자의 직접적인 개입이 있을 때 어떤 함수를 실행하도록 대기
- 웹브라우저 자체가 아닌 별도의 대상에 무언가를 요청하고 그에 대한 응답이 왔을 때 어떤 함수를 실행하도록 대기

=> 별도의 요청, 실행 대기, 보류와 관련

**비동기적인 일련의 작업을 동기적으로, 혹인 동기적인 것처럼 보이게끔 처리해주는 장치 마련**

1. ES6의 Promise
2. ES6의 Generator
3. ES2017의 async/await
   - 비동기 작업ㅇ르 수행하고자 하는 함수 앞에 async 표기
   - 함수 내부에서 실질적인 비동기 작업이 필요한 위치마다 await 표기
   - Promise의 then과 흡사한 효과을 얻을 수 있음
